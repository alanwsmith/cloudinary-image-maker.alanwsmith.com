<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Cloudinary Image Maker</title>
    <meta
      name="description"
      content="A tool to build Cloudinary image call URLs designed to make it easier to create open graph (OG) image templates for social cards"
    />

    <meta property="og:title" content="Cloudinary Image Maker" />
    <meta
      property="og:description"
      content="A tool to build Cloudinary image call URLs designed to make it easier to create open graph (OG) image templates for social cards"
    />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://cloudinary-image-maker.alanwsmith.com/"
    />
    <meta
      property="og:image"
      content="https://res.cloudinary.com/demo/image/upload/c_fill,w_1200,h_630/l_text:Oswald_70_bold:Cloudinary%20Image%20Maker/fl_layer_apply,g_north,y_24/c_fit,co_white,w_1200,h_38,bo_2px_solid_black,b_rgb:FEB61F55,l_text:Ubuntu_32_bold_stroke_alignmentvalue_center:Configure%20text%20and%20transformations%20with%20JSON/fl_layer_apply,g_north,y_108/c_fit,w_1200,co_rgb:ccd1a5,bo_2px_solid_black,l_text:Ubuntu_32_bold_stroke_alignmentvalue_center:cloudinary-image-maker.alanwsmith.com/fl_layer_apply,g_south,y_20/horses.jpg"
    />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:creator" content="@theidofalan" />
    <meta name="twitter:title" content="Cloudinary Image Maker" />
    <meta
      name="twitter:image"
      content="https://res.cloudinary.com/demo/image/upload/c_fill,w_1200,h_630/l_text:Oswald_70_bold:Cloudinary%20Image%20Maker/fl_layer_apply,g_north,y_24/c_fit,co_white,w_1200,h_38,bo_2px_solid_black,b_rgb:FEB61F55,l_text:Ubuntu_32_bold_stroke_alignmentvalue_center:Configure%20text%20and%20transformations%20with%20JSON/fl_layer_apply,g_north,y_108/c_fit,w_1200,co_rgb:ccd1a5,bo_2px_solid_black,l_text:Ubuntu_32_bold_stroke_alignmentvalue_center:cloudinary-image-maker.alanwsmith.com/fl_layer_apply,g_south,y_20/horses.jpg"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/favicons/16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/favicons/32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="/favicons/96x96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="128x128"
      href="/favicons/128x128.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="196x196"
      href="/favicons/196x196.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="228x228"
      href="/favicons/228x228.png"
    />
    <link
      rel="apple-touch-icon-precomposed"
      sizes="152x152"
      href="/favicons/152x152.png"
    />
    <link
      rel="apple-touch-icon-precomposed"
      sizes="167x167"
      href="/favicons/167x167.png"
    />
    <link
      rel="apple-touch-icon-precomposed"
      sizes="180x180"
      href="/favicons/180x180.png"
    />

    <style>
      /**********************\
      | Body
      \**********************/

      body {
        margin: 0;
        padding: 0;
        min-height: 100vh;
        display: grid;
        grid-template-rows: auto 1fr auto;
        font-size: 1.1rem;
      }

      /**********************\
      | Sections 
      \**********************/

      footer {
        width: 100%;
        max-width: 72ch;
        margin: 0 auto;
        text-align: center;
        padding-bottom: 12px;
        margin-top: 62px;
        font-size: 0.9rem;
      }

      header {
        width: 100%;
        max-width: 72ch;
        padding-top: 18px;
        padding-bottom: 4px;
        margin: 0 auto;
        border-bottom: 1px solid #888;
      }

      main {
        width: 100%;
        max-width: 72ch;
        margin: 0 auto;
      }

      /**********************\
      | Elements 
      \**********************/

      a {
        text-decoration: none;
      }

      input {
        box-sizing: border-box;
        width: 100%;
        margin-bottom: 6px;
      }

      li {
        padding-bottom: 4px;
      }

      textarea {
        box-sizing: border-box;
        width: 100%;
      }

      /**********************\
      | IDs 
      \**********************/

      #image_box {
        margin-bottom: 22px;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #image_preview {
        box-sizing: border-box;
        max-width: 100%;
      }

      /**********************\
      | Classes 
      \**********************/

      .pallet2 {
        background-color: #273c2c;
        color: #ffe8d6;
      }
      .pallet2 a {
        color: #b7b7a4;
      }
      .pallet2 footer {
        color: #a5a58d;
      }
    </style>

    <script type="text/javascript">
      const examples = [
        ///////////////////////////////////////////////////////
        {
          title: 'Initial example',
          notes: [],
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Welcome to the Cloudinary Image Maker. The json in this space",
    "configures a transformation. For example, the above image is",
    "generated by these current settings. Change them and after", 
    "a few seconds you'll see the preview image update live. The", 
    "examples will give you an idea of what you can do.",

    "I hope you find it useful.  -alan",

    "///////////////////////////////////////////////////////////////"
  ],
  
  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "horses",
  "FORMAT": "jpg",
  "SECTIONS": [
    [
      { "c_fill": [] },
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      {"l_text": ["Oswald_70_bold", "Cloudinary Image Maker" ] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north": [] },
      { "y_24": [] }
    ],
    [
      {"c_fit": [] },
      {"co_white": [] },
      {"w_1200": [] },
      {"h_38": [] },
      {"bo_2px_solid_black": [] },
      {"b_rgb": ["FEB61F55"] },
      {"l_text": ["Ubuntu_32_bold_stroke_alignmentvalue_center", "Configure text and transformations with JSON" ] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north": [] },
      { "y_108": [] }
    ],
    [
      {"c_fit": [] },
      {"w_1200": [] },
      {"co_rgb": ["ccd1a5"] },
      {"bo_2px_solid_black": [] },
      {"l_text": ["Ubuntu_32_bold_stroke_alignmentvalue_center", "cloudinary-image-maker.alanwsmith.com" ] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_south": [] },
      { "y_20": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Position text',
          notes: [],
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Positioning text is done by creating an 'l_text' text layer",
    "when using gravity (e.g. 'g_north_west') and 'x_' and 'y_'",
    "offsets for the position",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "base",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "l_text": ["Aldrich_40_bold", "Placed with g_north_west, x_20, y_20" ] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "x_20": [] },
      { "y_20": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Multiple text fields',
          notes: [],
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Multiple text layers are possible to creating each layer with",
    "'l_text', then placing it with 'fl_layer_apply' before moving",
    "on to the next one",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "base",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "l_text": ["ABeeZee_40_bold", "At the top via g_north and y_20" ] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north": [] },
      { "y_20": [] }
    ],
    [
      { "l_text": ["Aguafina Script_40_bold", "In the middle (no g_whatever applied)" ] }
    ],
    [
      { "fl_layer_apply": [] }
    ],
    [
      { "l_text": ["Averia Sans Libre_40_bold", "At the bottom via g_south and y_20" ] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_south": [] },
      { "y_20": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Text color and borders',
          notes: [],
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Use 'co_rgb' to set the font color and 'bo_10px_solid_rgb' to",
    "set a border of 10 pixels.",

    "Note that the font name must have '_stroke' in it for the",
    "border to work properly",

    "Setting the 'w_600' and 'c_fit' is necessary to prevent the",
    "border stroke line from being cut off at the start and end",
    "of the string. (You might need to do height ('h_') as well.",

    "And, as you can see from the example, the borders sometimes",
    "have artifacts and don't look that great",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "base",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "c_fit": [] },
      { "w_600": [] },
      { "co_rgb": ["777722"] },
      { "bo_10px_solid_rgb": ["732287"] },
      { "l_text": ["Kurale_40_stroke_bold_center", "This has a color and a border"] }
    ],
    [
      { "fl_layer_apply": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Automatically wrap long lines of text',
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Adding 'c_fit' to a 'l_text' layer that has a width set",
    "via 'w_' will automatically wrap the text.",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "base",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "c_fit": [] },
      { "l_text": ["Arial_32_bold", "This example uses \\"c_fit\\" to automatically wrap text to the next line when it hits the edge of the bounding box defined by \\"w_600\\".\\n\\nNew lines are done with \`\\\\n\\\\n\` and double quotes are done with \`\\\\\\"\`" ] },
      { "w_600": [] }
    ],
    [
      { "fl_layer_apply": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Crop in on a face with a circular mask',
          notes: [],
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Face detection is pretty good, but it's not flawless.",

    "///////////////////////////////////////////////////////////////"
  ],

          
  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "butterfly",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "c_thumb": [] },
      { "g_face": [] },
      { "w_332": [] },
      { "h_332": [] }
    ],
    [
      { "r_max": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Watermark an image',
          notes: [`This gets a breakup pattern started`],
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "In this case, the source image name for watermark", 
    "is: 'cloudinary_icon_blue'. A new layer with that image",
    "is created with 'l_cloudinary_icon_blue' and the opacity",
    "is set to 60% with 'o_60'. The layer is applied to the",
    "image with the 'fl_layer_apply' call",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "horses",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "c_fill": [] },
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "l_cloudinary_icon_blue": [] },
      { "c_fit": [] },
      { "w_1200": [] },
      { "h_630": [] },
      { "o_60": [] }
    ],
    [
      { "fl_layer_apply": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Watermark an image in the corner',
          notes: [`This gets a breakup pattern started`],
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "This is the same approach as the previous watermark, but",
    "the image size has been reduce to 30% with 'w_0.3' and the",
    "image moved via: 'g_south_east', 'x_20', 'y_20'",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "horses",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "c_fill": [] },
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "l_cloudinary_icon_blue": [] }
    ],
    [
      { "w_0.3": [] },
      { "o_60": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_south_east": [] },
      { "x_20": [] },
      { "y_20": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Overlay a color on an image',
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "This uses a 1 pixel white image, applies a color ",
    "to it and then dials down the opacity to create a",
    "color wash over the entire image",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "horses",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "c_fill": [] },
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "l_1px-white": [] },
      { "w_1200": [] },
      { "h_630": [] },
      { "e_colorize": [] },
      { "co_rgb": ["d11b30"] },
      { "o_60": [] }
    ],
    [
      { "fl_layer_apply": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Get a Gravatar image',
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Pulling gravatar images is done by making an md5 hash of",
    "the email address associated with the image",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/gravatar",
  "BASE_IMAGE": "ec8e27851eef45968d23b9be06ba9eb5",
  "FORMAT": "jpg",
  "SECTIONS": [
    [
      { "h_332": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Use a remote image',
          notes: [
            `Some urls contain special characters that need to be encoded. This process doesn't try to deal with that.`,
            `More details are here: https://cloudinary.com/documentation/fetch_remote_images#creating_a_fetch_url_containing_special_characters`,
            `Note that there's no format here. The 'f_auto' is set to determine it`,
            `If you try to set a format, sometimes it conflicts with the remote URL and breaks the process`,
            `Check out the multiple remote image call for ways to work around problematic URLs by making the calls via 'l_fetch' and a base64 encoded url`,
          ],
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Calling image from other sites is possible assuming the",
    "account has been setup to allow it. Here, the image is",
    "called as the last part in the URL.",

    "Note that no FORMAT was set as that can mess with the image",
    "pull. This example uses 'f_auto' to set the final output to",
    "what cloudinary determines is the best one",

    "If you need to define the format explicitly, you can use",
    "the layer approach in the multiple remote images example",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/fetch",
  "BASE_IMAGE": "https://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/Commodore_Grace_M._Hopper%2C_USN_%28covered%29.jpg/1920px-Commodore_Grace_M._Hopper%2C_USN_%28covered%29.jpg",
  "FORMAT": "",
  "SECTIONS": [
    [
      { "h_332": [] }
    ],
    [
      { "f_auto": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Multiple remote images',
          notes: [
            `multiple remote images need to be base64 encoded which this process handles.`,
            `the borders in these images are from the source material, not something applied by cloudinary. though, that is possible`,
          ],
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Calling multiple remote images requires the URLs to be",
    "base64 encoded. That's handled here automatically so you can",
    "just use the normal url",

    "The pattern is to define the image to call with 'l_fetch'", 
    "apply any settings in the next section (e.g. 'w_100'), then",
    "place it with the 'fl_layer_apply' call and optional",
    "gravity ('g_') and 'x_' and 'y_' offsets.",

    "Note that the 'base' image in this case is plain white",
    "image that is stretched to the desired dimensions via",
    "the first section's 'w_525' and 'h_350'",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "base",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "w_1200": [] },
      { "h_630": [] }
    ],

    [
      { "l_fetch": ["https://tile.loc.gov/storage-services/service/pnp/cph/3c20000/3c24000/3c24600/3c24690r.jpg"] }
    ],
    [
      { "w_200": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "y_40": [] },
      { "x_80": [] }
    ],

    [
      { "l_fetch": ["https://tile.loc.gov/storage-services/service/pnp/cph/3c20000/3c24000/3c24600/3c24694r.jpg"] }
    ],
    [
      { "w_200": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "y_40": [] },
      { "x_360": [] }
    ],

    [
      { "l_fetch": ["https://tile.loc.gov/storage-services/service/pnp/cph/3c20000/3c24000/3c24700/3c24714r.jpg"] }
    ],
    [
      { "w_200": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "y_40": [] },
      { "x_640": [] }
    ],

    [
      { "l_fetch": ["https://tile.loc.gov/storage-services/service/pnp/cph/3c20000/3c24000/3c24700/3c24711r.jpg"] }
    ],
    [
      { "w_200": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "y_40": [] },
      { "x_920": [] }
    ],

    [
      { "l_fetch": ["https://tile.loc.gov/storage-services/service/pnp/cph/3c20000/3c24000/3c24700/3c24701r.jpg"] }
    ],
    [
      { "w_200": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "y_336": [] },
      { "x_80": [] }
    ],

    [
      { "l_fetch": ["https://tile.loc.gov/storage-services/service/pnp/cph/3c20000/3c24000/3c24700/3c24705r.jpg"] }
    ],
    [
      { "w_200": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "y_336": [] },
      { "x_360": [] }
    ],

    [
      { "l_fetch": ["https://tile.loc.gov/storage-services/service/pnp/cph/3c20000/3c24000/3c24700/3c24707r.jpg"] }
    ],
    [
      { "w_200": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "y_336": [] },
      { "x_640": [] }
    ],

    [
      { "l_fetch": ["https://tile.loc.gov/storage-services/service/pnp/cph/3c20000/3c24000/3c24700/3c24708r.jpg"] }
    ],
    [
      { "w_200": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "y_336": [] },
      { "x_920": [] }
    ]

  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Generate a background with a specific color',
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "This uses an image named base that's nothing but a white square",

    "The actual image doesn't matter as the entire thing is",
    "colored over",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "base",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "w_1200": [] },
      { "h_630": [] },
      { "b_rgb": ["9a0000"] },
      { "o_0": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Generate a breakup pattern',
          notes: [`This gets a breakup pattern started`],
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "This was just an experiment to see about creating a pattern",
    "with nothing but a white image to start with. There's not",
    "a lot of options, but playing various transformations and",
    "artistic filters might lead to some interesting effects",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "base",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "w_1200": [] },
      { "h_630": [] },
      { "b_rgb": ["9a2323"] },
      { "o_0": [] }
    ],
    [ { "e_art": ["sizzle"]} ],
    [ { "e_noise": ["50"]} ],
    [
      { "e_ordered_dither": ["17"] }
      ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Create a rectangle',
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "It's possible to create basic shapes by completely covering",
    "an image on a layer. I'm using a 1px-wite sample image as",
    "the base, but anything will do since the size is set in",
    "the code and the color covers the entire area",

    "Positioning is done with 'g_', 'x_', and 'y_'",
  
    "The color is defined via 'co_rgb' and then applied with",
    "'e_colorize' set to 100",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "horses",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "c_fill": [] },
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "l_1px-white": [] }
    ],
    [
      { "w_240": [] },
      { "h_180": [] },
      { "co_rgb": ["9a0000"] },
      { "e_colorize": ["100"] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "x_40": [] },
      { "y_40": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Create a circle',
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Same basic setup as the rectangle, but 'r_max' is used",
    "turn it into a circle",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "horses",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "c_fill": [] },
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "l_1px-white": [] }
    ],
    [
      { "w_90": [] },
      { "h_90": [] },
      { "co_rgb": ["9a0000"] },
      { "e_colorize": ["100"] },
      { "r_max": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "g_north_west": [] },
      { "x_40": [] },
      { "y_40": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Create a triangle',
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "Making a triangle is complicated, but doable",

    "This approach makes a square and cuts it into a triangle",
    "with another square placed over it at a different angle",

    "The main image has to be repeated as an underlay with 'u_'",

    "Skipping that 'u_' layer while you're doing the positioning", 
    "let's you see the parts which makes it easier to line up.",

    "The edge that gets cut out has a blur to it",
    
    "I'm sure there's math that can make placing the components",
    "properly easy, but I just did trial and error. If you know that",
    "math, please send it to me",

    "There may be another approach that doesn't cause the blur,",
    "but that's left as an exercise for the reader",

    "Probably better off making your own images of triangles",
    "and placing them",


    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "horses",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "c_fill": [] },
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "l_base": [] }
    ],
    [
      { "w_250": [] },
      { "h_250": [] },
      { "co_rgb": ["9a0000"] },
      { "e_colorize": ["100"] }
    ],
    [
      { "fl_layer_apply": [] }
    ],
    [
      { "l_base": [] },
      { "w_540": [] },
      { "h_540": [] },
      { "a_30": [] }
    ],
    [
      { "e_cut_out": [] },
      { "fl_layer_apply": [] },
      { "g_east": [] },
      { "x_210": [] },
      { "y_40": [] }
    ],
    [
      { "u_horses": [] },
      { "c_fill": [] },
      { "w_1200": [] },
      { "h_630": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////

        {
          title: 'Create semi-transparent shapes',
          code: `{
  "__INTRO__": [

    "///////////////////////////////////////////////////////////////",

    "The setup for how to have semi-transparency",

    "This is where things get interesting for some random,",
    "generative art stuff. Looking forward to playing around",
    "with that",

    "///////////////////////////////////////////////////////////////"
  ],

  "ROOT_URL": "https://res.cloudinary.com/demo/image/upload",
  "BASE_IMAGE": "base",
  "FORMAT": "png",
  "SECTIONS": [
    [
      { "w_1200": [] },
      { "h_630": [] }
    ],
    [
      { "l_1px-white": [] }
    ],
    [
      { "w_440": [] },
      { "h_60": [] },
      { "co_rgb": ["F9331F"] },
      { "e_colorize": ["100"] }
    ],
    [
      { "fl_layer_apply": [] }
    ],
    [
      { "l_1px-white": [] }
    ],
    [
      { "w_180": [] },
      { "h_180": [] },
      { "co_rgb": ["628422"] },
      { "e_colorize": ["100"] },
      { "o_60": [] },
      { "r_max": [] }
    ],
    [
      { "fl_layer_apply": [] },
      { "x_-60": [] }
    ]
  ]
}`,
        },

        ///////////////////////////////////////////////////////
        // Close Example Config
        ///////////////////////////////////////////////////////
      ]

      //////////////////////////////////////////////////////
      // Start script stuff
      //////////////////////////////////////////////////////
      function updateUrl() {
        console.log('Updating URL')
        const assembly = []
        try {
          const data = JSON.parse(document.getElementById('source_block').value)
          assembly.push(data.ROOT_URL)
          data.SECTIONS.forEach((section) => {
            const parts = []
            section.forEach((item) => {
              console.log(item)
              const item_string = [Object.keys(item)[0]]
              console.log(item_string[0])

              if (item_string[0] === 'l_fetch') {
                console.log(`Encoding remote url: ${item[item_string[0]][0]}`)
                item_string.push(btoa(item[item_string[0]][0]))
              } else {
                item[item_string[0]].forEach((sub_string) => {
                  const encoded_string = encodeURIComponent(sub_string)
                  const comma_fixed_string = encoded_string.replace(
                    /%2C/g,
                    '%252C'
                  )
                  item_string.push(comma_fixed_string)
                })
              }

              parts.push(item_string.join(':'))
            })
            assembly.push(parts.join(','))
          })

          if (data.FORMAT !== '') {
            assembly.push(`${data.BASE_IMAGE}.${data.FORMAT}`)
          } else {
            assembly.push(data.BASE_IMAGE)
          }

          const output_url = assembly.join('/')
          document.getElementById('output_url').value = output_url
          document.getElementById('new_tab_url').href = output_url
          generate_preview()

          // return output_url
        } catch (error) {
          document.getElementById('output_url').value = 'Invalid JSON'
          console.log('Invalid JSON')
        }
      }

      let debounce_count = 0
      let update_immediately = false

      function generate_preview() {
        console.log('Got request to generate preview')
        if (update_immediately === true) {
          console.log('Updating immediately')
          update_immediately = false
          document.getElementById('image_preview').src =
            document.getElementById('output_url').value
        } else {
          console.log(`Updating via debounce`)
          console.log('Incrementing debounce count')
          debounce_count += 1
          var timeoutId = setTimeout(() => {
            console.log(`Finished debounce wait. Checking if it's safe`)
            debounce_count -= 1
            if (debounce_count > 0) {
              console.log(`Not yet ready: ${debounce_count} left to go`)
            } else {
              console.log(`It's ready. do the thing`)
              document.getElementById('image_preview').src =
                document.getElementById('output_url').value
              debounce_count = 0
            }
          }, 640)
        }
      }

      function load_example(event) {
        console.log(`Loading example: ${event.target.id}`)
        const split_id = event.target.id.split('_')
        document.getElementById('source_block').value =
          examples[split_id[1]].code
        update_immediately = true
        updateUrl()
      }

      // Setup copy button
      function copyClipBoard(event) {
        // via b1mind :-)
        let tempInput = document.createElement('textarea')
        tempInput.value = document.getElementById('output_url').value
        document.body.appendChild(tempInput)
        tempInput.select()
        document.execCommand('copy')
        document.body.removeChild(tempInput)
      }

      function setupAndGo() {
        // Add event listener for copy button
        const copy_button = document.getElementById('copy_button')
        copy_button.addEventListener('click', copyClipBoard)

        // Build example buttons
        const example_section = document.getElementById('examples_section')
        examples.forEach((example, example_index) => {
          example_button = document.createElement('button')
          example_button.id = `example_${example_index}`
          example_button.innerHTML = examples[example_index].title
          example_button.addEventListener('click', load_example)
          example_section.appendChild(example_button)
        })

        // Setup initial json block
        const source_block = document.getElementById('source_block')
        /////////////////////////////////
        // Use `examples[0].code` for the first example
        // Or, `examples[examples.length - 1].code` for the last
        //
        source_block.value = examples[0].code
        // source_block.value = examples[examples.length - 1].code
        //
        /////////////////////////////////
        source_block.addEventListener('input', updateUrl)
        update_immediately = true
        updateUrl()
      }
      document.addEventListener('DOMContentLoaded', setupAndGo)
    </script>
  </head>
  <body>
    <script type="text/javascript">
      document.body.className = 'pallet2'
    </script>
    <header>
      <a href="https://www.alanwsmith.com/">alanwsmith.com</a> ~
      <a href="https://links.alanwsmith.com">links</a> ~
      <a href="https://podcast.alanwsmith.com/">podcast</a>
    </header>
    <main>
      <h1>Cloudinary Image Maker</h1>
      <p>
        Configuring cloudinary urls by hand is a tedious. I made this to make it
        easier. (It's json so it's still kinda tedious, but I find it easier
        than trying to mess with URLs. Especially when there are long text
        strings and escaping involved)
      </p>
      <p>
        I use it to design templates for open graph (OG) images for the social
        network cards that show up when you share a link. It's nothing fancy.
        You edit the json in the box below and a preview of the images along
        with the url.
      </p>

      <p>Check out these examples to get you started</p>

      <!-- buttons are attached to this h3. leave it until
        you attach them to something else -->

      <h3 id="examples_section"></h3>

      <hr />

      <div id="image_box">
        <a id="new_tab_url" target="_blank">
          <img id="image_preview" />
        </a>
      </div>

      <hr />

      <div>
        <button id="copy_button">Copy URL</button>
        <input type="text" id="output_url" size="70" readonly="readonly" />
      </div>

      <hr />

      <div>
        Configure your transformation here:
        <textarea id="source_block" cols="10" rows="23"></textarea>
      </div>

      <hr />
      <h3>Notes</h3>
      <ul>
        <li>
          The examples that use &quot;c_fill&quot; cut off parts of the image to
          keep the desired perspective without distorting the image. Check out
          <a
            href="https://cloudinary.com/documentation/transformation_reference#c_crop_resize"
            >the docs</a
          >
          for alternatives.
        </li>
        <li>
          Usage details are below, but I find it's easier to just click around
          the exmaples and look at the code to figure out how things work
        </li>
        <li>
          The cloudinary reference docs with all the stuff you can do
          <a href="https://cloudinary.com/documentation/image_transformations"
            >are here</a
          >
        </li>
        <li>
          The preview image width is constrained. The generated urls are
          unaffected by this and will resize to whatever dimensions you spec out
        </li>
        <li>
          Cloudinary's api does a bunch of stuff. This doesn't cover everything,
          but it'll get you pretty far. (and you can always just drop an entire
          string with whatever you want into a section to trigger it)
        </li>
        <li>
          You're supposed to be able to get images from Twitter and YouTube, but
          those failed for me even when I hand assembled the urls based of the
          documentation.
        </li>
        <li>
          The text samples show how to set fonts like 'Averia Sans
          Libre_19_bold'. Leave any spaces in the font names and they'll be
          formatted correctly when the url is generated.
        </li>
        <li>
          Some google fonts are available for use. I put together a list here:
          <a
            href="https://www.alanwsmith.com/posts/26mqi8ovvtka--google-fonts-you-can-use-in-cloudinary-transformations"
            >google fonts you can use in cloudinary transformations</a
          >
        </li>
        <li>
          Use `:` as the seperator if you need to use an image from that's in a
          folder on in the cloudinary media libray. For example, `{
          "l_og-images:1x1-white": [] }`
        </li>
        <li>
          There is a `letter_spacing` option but as far as I can tell it only
          increases spacing and can't contract it.
        </li>
        <li>
          You can pass font weights to the text calls (e.g. `Source Sans
          Pro_80_900`)
        </li>
      </ul>

      <h3>Usage</h3>
      <ul>
        <li>
          You can use versions and folders in the BASE_IMAGE (e.g.
          &quot;v1643773709/og-images/blank-v4&quot;)
        </li>
        <li>
          Trailing commas in the json don't work (formatters usually spread this
          across multiple lines, but something like this `['a', 'b', 'c',]` will
          choke). If you get an invalid json, that's the first thing to check
        </li>
        <li>Both object keys and values require double quotes</li>
        <li>
          Each &quot;section&quot; in the &quot;SECTIONS&quot; array represents
          code that will go in between slashes in the final url
        </li>
        <li>Each section is itself an array of item objects</li>
        <li>Each item object has exactly one key and one value</li>
        <li>The value of the item objects are always arrays of parameters</li>
        <li>
          The item object parameters array always exists, but it can be empty
        </li>
        <li>In sections, individual items are joined with commas</li>
        <li>
          If there are parameters on an item, those are joined to their
          corresponding key with &quot;:&quot; characters.
        </li>
        <li>Text is in the parameters is automatically encoded for urls</li>
        <li>
          Add an slash to escape quotes to use them in text (i.e. `\&quot;`)
        </li>
        <li>Text must all be on one line in the json</li>
        <li>Paragraphs can be created by adding two newlines (i.e. `\n\n`)</li>
        <li>
          Commas in text are replaced with a double escape sequence to prevent
          them from conflicting with cloudinary's functionality
        </li>
      </ul>

      <h3>Possible Enhancements</h3>
      <ul>
        <li>
          Setup so the tab key adds tabs in the box instead of tabbing to the
          next window
        </li>
        <li>
          Setup so that if there's an invalid json or the image isn't there the
          area doesn't collapse and shift the textarea around
        </li>
        <li>Add vim controls</li>

        <li>Made this thing responsive</li>
        <li>
          move off of document.execCommand() to the newer navigation api for
          copying the url to the clipboard
        </li>
        <li>
          Have the image switch to some type of loading spinner when a new image
          is being genearted
        </li>
        <li>Make a button that adds a new section stub</li>
        <li>Make a button that adds a new item to the last section</li>
        <li>
          Maybe handle newlines in strings to make it easier to see longer lines
          of text
        </li>
        <li>Store json history in local storage</li>
        <li>
          Setup the ability to post samples and code to twitter for storage,
          reference, and sharing
        </li>
        <li>Wire up prettier or another json formatter</li>
        <li>Add syntax highlighting</li>
        <li>Maybe split out the json sections to individual text areas</li>
        <li>
          Reverse the process so you can drop in a url that gets parsed out to a
          json for editing
        </li>
        <li>Examples with artistic filters</li>
        <li>Generate a page with font samples for available fonts</li>
        <li>Show a backup default image example</li>
        <li>Look at the layout stuff for making pdfs</li>
        <li>Show a colorblind assist example</li>
        <li>
          look at conditionals and variables for possibility of generative art
        </li>
        <li>see if masking layers can make better triangles</li>
        <li>Look into css sprite creation</li>
        <li>See how their responsive images work</li>
        <li>Look at custom functions and wasm stuff</li>
      </ul>
    </main>
    <footer>
      made by <a href="https://twitter.com/TheIdOfAlan">alan w. smith</a>
      <br />
      who has a <a href="https://www.alanwsmith.com">website</a> and a
      <a href="https://podcast.alanwsmith.com/">podcast</a> <br />
      among other <a href="https://links.alanwsmith.com">things</a>
    </footer>
  </body>
</html>
